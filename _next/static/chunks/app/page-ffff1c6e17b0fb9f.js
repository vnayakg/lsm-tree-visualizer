(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{5220:(e,t,a)=>{"use strict";a.d(t,{D:()=>o,ThemeProvider:()=>i});var s=a(5155),l=a(2115);let r=(0,l.createContext)({theme:"system",setTheme:()=>{},resolvedTheme:"light"}),o=()=>{let e=(0,l.useContext)(r);if(!e)throw Error("useTheme must be used within ThemeProvider");return e},i=e=>{let{children:t}=e,[a,o]=(0,l.useState)("system"),[i,n]=(0,l.useState)("light"),[c,d]=(0,l.useState)(!1),m=(0,l.useCallback)(()=>window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",[]),u=(0,l.useCallback)(e=>"system"===e?m():e,[m]),b=(0,l.useCallback)(e=>{let t=u(e);n(t);let a=document.documentElement;a.classList.remove("light","dark"),a.classList.add(t)},[u]);return((0,l.useEffect)(()=>{d(!0);let e=localStorage.getItem("lsm-theme")||"system";o(e),b(e)},[b]),(0,l.useEffect)(()=>{if(!c)return;let e=window.matchMedia("(prefers-color-scheme: dark)"),t=()=>{"system"===a&&b("system")};return e.addEventListener("change",t),()=>e.removeEventListener("change",t)},[a,c,b]),c)?(0,s.jsx)(r.Provider,{value:{theme:a,setTheme:e=>{o(e),localStorage.setItem("lsm-theme",e),b(e)},resolvedTheme:i},children:t}):(0,s.jsx)(s.Fragment,{children:t})}},6326:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>P});var s=a(5155),l=a(9137),r=a.n(l),o=a(2115);let i="__DELETED__";class n{put(e,t){return this.data.has(e)&&(this.mutationOrder=this.mutationOrder.filter(t=>t!==e)),this.mutationOrder.push(e),this.data.set(e,t),'Key "'.concat(e,'" set in MemTable.')}get(e){return this.data.get(e)}delete(e){return this.put(e,i)}isFull(){return this.data.size>=this.maxSize}flush(){let e=Array.from(this.data.entries()).sort((e,t)=>e[0].localeCompare(t[0]));return this.data.clear(),this.mutationOrder=[],e}getDataForViz(){return Array.from(this.data.entries()).sort((e,t)=>e[0].localeCompare(t[0]))}constructor(e){this.maxSize=e,this.data=new Map,this.mutationOrder=[]}}let c=()=>"sstable-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,5)),d=(e,t)=>{let a=0,s=e.length-1;for(;a<=s;){let l=Math.floor((a+s)/2);if(e[l][0]===t)return e[l][1];e[l][0]<t?a=l+1:s=l-1}};class m{get(e){return d(this.data,e)}getDataForViz(){return this.data}getKeyRange(){return{minKey:this.minKey,maxKey:this.maxKey}}overlaps(e,t){return!!this.minKey&&!!this.maxKey&&!!e&&!!t&&this.minKey<=t&&this.maxKey>=e}constructor(e,t,a=[]){this.id=e,this.level=t,this.data=a,this.minKey=a.length>0?a[0][0]:null,this.maxKey=a.length>0?a[a.length-1][0]:null}}class u{_addLog(e){this.log.unshift({text:e,time:new Date().toLocaleTimeString()}),this.log.length>100&&this.log.pop()}put(e,t){if(!e)return void this._addLog("Write failed: Key cannot be empty.");if(this.memtable.isFull()&&(this._addLog("MemTable is full, attempting to flush first."),this.flushMemTable()),this.memtable.isFull())return void this._addLog("Write failed: MemTable is still full. Compaction might be needed or L0 is at capacity and cannot be compacted further.");let a=this.memtable.put(e,t);this._addLog(a),this.metrics.logicalWrites++,this.memtable.isFull()&&this.flushMemTable(),this.triggerCompactionIfNeeded()}delete(e){if(!e)return void this._addLog("Delete failed: Key cannot be empty.");if(this.memtable.isFull()&&(this._addLog("MemTable is full, attempting to flush first."),this.flushMemTable()),this.memtable.isFull())return void this._addLog("Delete failed: MemTable is still full. Compaction might be needed.");let t=this.memtable.delete(e);this._addLog(t),this.metrics.logicalWrites++,this.memtable.isFull()&&this.flushMemTable(),this.triggerCompactionIfNeeded()}get(e){if(!e)return this._addLog("Read failed: Key cannot be empty."),{value:void 0,path:[]};let t=[];this._addLog('Searching for key "'.concat(e,'"...')),this.metrics.logicalReads++,t.push({component:"MemTable",id:"memtable",status:"Checking"}),this.metrics.memtableLookupsForRead++;let a=this.memtable.get(e);if(void 0!==a)return a===i?(this._addLog('Key "'.concat(e,'" found in MemTable as TOMBSTONE.')),t[t.length-1].status="Found (Tombstone)",{value:i,path:t}):(this._addLog('Key "'.concat(e,'" found in MemTable. Value: "').concat(a,'".')),t[t.length-1].status="Found",{value:a,path:t});t[t.length-1].status="Not Found";for(let s=0;s<this.levels.length;s++){let l=this.levels[s];for(let r of 0===s?[...l].reverse():l)if(!(s>0)||!r.minKey||!r.maxKey||!(e<r.minKey)&&!(e>r.maxKey)){if(t.push({component:"L".concat(s," SSTable"),id:r.id,status:"Checking"}),this.metrics.sstablesAccessedForRead++,void 0!==(a=r.get(e))){if(a===i)return this._addLog('Key "'.concat(e,'" found in SSTable ').concat(r.id," (L").concat(s,") as TOMBSTONE.")),t[t.length-1].status="Found (Tombstone)",{value:i,path:t};return this._addLog('Key "'.concat(e,'" found in SSTable ').concat(r.id," (L").concat(s,'). Value: "').concat(a,'".')),t[t.length-1].status="Found",{value:a,path:t}}t[t.length-1].status="Not Found"}}return this._addLog('Key "'.concat(e,'" not found in any SSTable.')),{value:void 0,path:t}}flushMemTable(){if(0===this.memtable.data.size)return this._addLog("MemTable is empty, nothing to flush."),!1;this._addLog("Flushing MemTable to L0...");let e=this.memtable.flush(),t=new m(c(),0,e);return this.levels[0].push(t),this._addLog("Flushed MemTable to new SSTable ".concat(t.id," in L0. Contains ").concat(e.length," items.")),this.metrics.itemsWrittenToSSTables+=e.length,!0}triggerCompactionIfNeeded(){this.levels[0].length>this.config.l0MaxSSTables&&this.compact(0);for(let e=0;e<this.config.maxLevels-1;e++){let t=0===e?this.config.l0MaxSSTables:this.config.l0MaxSSTables*Math.pow(this.config.levelMaxSSTablesFactor,e);this.levels[e].length>t&&this.compact(e)}}compact(e){let t;if(e>=this.config.maxLevels-1)return void this._addLog("Cannot compact L".concat(e," as it's the last configured level."));let a=e+1;this._addLog("Attempting compaction from L".concat(e," to L").concat(a,"..."));let s=[];if(0===e){if(this.levels[0].length<=this.config.l0MaxSSTables&&this.levels[0].length>0)t=[...this.levels[0]],this.levels[0]=[];else{if(!(this.levels[0].length>this.config.l0MaxSSTables))return void this._addLog("L0 has ".concat(this.levels[0].length," tables, not exceeding limit of ").concat(this.config.l0MaxSSTables,". No L0 compaction triggered by threshold."));t=[...this.levels[0]],this.levels[0]=[]}for(let e of(this._addLog("Selected ".concat(t.length," SSTables from L0 for compaction.")),t))if(e.minKey&&e.maxKey)for(let t of this.levels[a])t.overlaps(e.minKey,e.maxKey)&&!s.find(e=>e.id===t.id)&&s.push(t)}else{if(0===this.levels[e].length)return void this._addLog("L".concat(e," is empty. No compaction needed."));let l=(t=[this.levels[e].shift()])[0];if(this._addLog("Selected oldest SSTable ".concat(l.id," from L").concat(e,".")),l.minKey&&l.maxKey)for(let e of this.levels[a])e.overlaps(l.minKey,l.maxKey)&&s.push(e)}if(0===t.length)return void this._addLog("No tables selected for compaction from L".concat(e,". Compaction aborted."));this._addLog("Found ".concat(s.length," overlapping SSTables in L").concat(a," to include in merge.")),this.levels[a]=this.levels[a].filter(e=>!s.find(t=>t.id===e.id));let l=[...t,...s];if(0===l.length){this._addLog("No tables to merge in compaction process. Aborting."),e>0?this.levels[e].unshift(...t):this.levels[e].push(...t);return}this._addLog("Merging the following SSTables: ".concat(l.map(e=>"".concat(e.id,"(L").concat(e.level,")")).join(", "),"."));let r=new Map;for(let e of[...l].sort((e,t)=>e.level!==t.level?e.level-t.level:t.id.localeCompare(e.id)))for(let[t,a]of e.getDataForViz())r.has(t)||r.set(t,a);let o=Array.from(r.entries()).filter(t=>{let[a,s]=t;return s!==i||e<this.config.maxLevels-2}).sort((e,t)=>e[0].localeCompare(t[0]));this._addLog("Merged data resulted in ".concat(o.length," unique, live keys.")),this.metrics.itemsWrittenToSSTables+=o.length;for(let e=0;e<o.length;e+=this.config.sstableMaxItems){let t=o.slice(e,e+this.config.sstableMaxItems);if(t.length>0){let e=new m(c(),a,t);this.levels[a].push(e),this._addLog("Created new SSTable ".concat(e.id," in L").concat(a," with ").concat(t.length," items."))}}a>0&&this.levels[a].sort((e,t)=>null===e.minKey&&null===t.minKey?0:null===e.minKey?-1:null===t.minKey?1:e.minKey.localeCompare(t.minKey)),this._addLog("Compaction from L".concat(e," to L").concat(a," complete.")),this.triggerCompactionIfNeeded()}getMetrics(){let e=this.metrics.logicalWrites>0?this.metrics.itemsWrittenToSSTables/this.metrics.logicalWrites:0,t=this.metrics.logicalReads>0?this.metrics.sstablesAccessedForRead/this.metrics.logicalReads:0;return{...this.metrics,writeAmplification:e.toFixed(2),readAmplificationSSTables:t.toFixed(2)}}getState(){return{memtable:this.memtable.getDataForViz(),levels:this.levels.map(e=>e.map(e=>({id:e.id,level:e.level,data:e.getDataForViz(),minKey:e.minKey,maxKey:e.maxKey}))),log:[...this.log],config:{...this.config},metrics:this.getMetrics()}}reset(e){this.config={memtableMaxSize:e.memtableMaxSize||5,l0MaxSSTables:e.l0MaxSSTables||3,levelMaxSSTablesFactor:e.levelMaxSSTablesFactor||4,sstableMaxItems:e.sstableMaxItems||10,maxLevels:e.maxLevels||5},this.memtable=new n(this.config.memtableMaxSize),this.levels=Array(this.config.maxLevels).fill(null).map(()=>[]),this.log=[],this.metrics={logicalWrites:0,itemsWrittenToSSTables:0,logicalReads:0,sstablesAccessedForRead:0,memtableLookupsForRead:0},this._addLog("LSM Tree has been reset with new configuration.")}constructor(e={}){this.config={memtableMaxSize:e.memtableMaxSize||5,l0MaxSSTables:e.l0MaxSSTables||3,levelMaxSSTablesFactor:e.levelMaxSSTablesFactor||4,sstableMaxItems:e.sstableMaxItems||10,maxLevels:e.maxLevels||5},this.memtable=new n(this.config.memtableMaxSize),this.levels=Array(this.config.maxLevels).fill(null).map(()=>[]),this.log=[],this.metrics={logicalWrites:0,itemsWrittenToSSTables:0,logicalReads:0,sstablesAccessedForRead:0,memtableLookupsForRead:0},this._addLog("LSM Tree initialized.")}}var b=a(381),h=a(6474),x=a(3052),g=a(4788);let v=e=>{let{text:t,children:a}=e,[l,r]=(0,o.useState)(!1);return(0,s.jsxs)("div",{className:"relative inline-block",onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1),children:[a,l&&(0,s.jsx)("div",{className:"absolute z-50 bottom-full mb-2 left-1/2 transform -translate-x-1/2 px-3 py-2 text-sm font-medium rounded-lg shadow-sm whitespace-nowrap",style:{background:"var(--tooltip-bg)",color:"var(--tooltip-text)"},children:t})]})},f=e=>{let{initialConfig:t,onSave:a,onResetDefault:l}=e,[r,i]=(0,o.useState)(t),[n,c]=(0,o.useState)(!1);(0,o.useEffect)(()=>{i(t)},[t]);let d=e=>{let{name:t,value:a}=e.target,s=parseInt(a,10);i(e=>({...e,[t]:s>0?s:1}))};return(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("button",{onClick:()=>c(!n),className:"p-2 rounded-md flex items-center transition-colors",style:{background:"var(--btn-blue-bg)",color:"var(--text-inverse)"},onMouseEnter:e=>e.currentTarget.style.background="var(--btn-blue-hover)",onMouseLeave:e=>e.currentTarget.style.background="var(--btn-blue-bg)",children:[(0,s.jsx)(b.A,{size:20,className:"mr-2"}),"Settings",n?(0,s.jsx)(h.A,{size:20,className:"ml-1"}):(0,s.jsx)(x.A,{size:20,className:"ml-1"})]}),n&&(0,s.jsxs)("div",{className:"mt-2 p-4 rounded-lg",style:{border:"1px solid var(--border-primary)",background:"var(--bg-card-secondary)",boxShadow:"var(--shadow-sm)"},children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-3",style:{color:"var(--text-primary)"},children:"LSM Tree Configuration"}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[{name:"memtableMaxSize",label:"MemTable Max Size",tip:"Max items in MemTable before flush."},{name:"l0MaxSSTables",label:"L0 Max SSTables",tip:"Max SSTables in L0 before compaction to L1."},{name:"levelMaxSSTablesFactor",label:"Level Max SSTables Factor",tip:"Multiplier for max tables in next level (approx). Ln_max = L0_max * factor^(n-1) for L1+"},{name:"sstableMaxItems",label:"SSTable Max Items",tip:"Max items per SSTable created during compaction."},{name:"maxLevels",label:"Max Levels",tip:"Total number of levels (L0 to L(N-1)). Min 2."}].map(e=>(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsxs)("label",{htmlFor:e.name,className:"text-sm font-medium mb-1 flex items-center",style:{color:"var(--text-secondary)"},children:[e.label,(0,s.jsx)(v,{text:e.tip,children:(0,s.jsx)(g.A,{size:14,className:"ml-1 cursor-help",style:{color:"var(--text-tertiary)"}})})]}),(0,s.jsx)("input",{type:"number",id:e.name,name:e.name,value:r[e.name],onChange:d,min:"1",className:"p-2 rounded-md",style:{border:"1px solid var(--border-primary)",background:"var(--bg-input)",color:"var(--text-primary)"}})]},e.name))}),(0,s.jsxs)("div",{className:"mt-4 flex space-x-2",children:[(0,s.jsx)("button",{onClick:()=>{a(r),c(!1)},className:"px-4 py-2 rounded-md transition-colors",style:{background:"var(--btn-green-bg)",color:"var(--text-inverse)"},onMouseEnter:e=>e.currentTarget.style.background="var(--btn-green-hover)",onMouseLeave:e=>e.currentTarget.style.background="var(--btn-green-bg)",children:"Save & Apply"}),(0,s.jsx)("button",{onClick:()=>{let e={memtableMaxSize:5,l0MaxSSTables:3,levelMaxSSTablesFactor:4,sstableMaxItems:10,maxLevels:5};i(e),a(e),c(!1)},className:"px-4 py-2 rounded-md transition-colors",style:{background:"var(--btn-yellow-bg)",color:"var(--text-inverse)"},onMouseEnter:e=>e.currentTarget.style.background="var(--btn-yellow-hover)",onMouseLeave:e=>e.currentTarget.style.background="var(--btn-yellow-bg)",children:"Reset to Defaults"})]})]})]})};var p=a(4940),y=a(2525),S=a(7924),j=a(1539),T=a(133);let k=e=>{let{onWrite:t,onRead:a,onDelete:l,onCompact:r,onResetTree:i,isCompacting:n}=e,[c,d]=(0,o.useState)(""),[m,u]=(0,o.useState)(""),[b,h]=(0,o.useState)("");return(0,s.jsxs)("div",{className:"p-4 shadow-md rounded-lg mb-6",style:{background:"var(--bg-card)",boxShadow:"var(--shadow-md)"},children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",style:{color:"var(--text-primary)"},children:"Controls"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 items-end",children:[(0,s.jsxs)("div",{className:"space-y-3 p-3 rounded-md",style:{border:"1px solid var(--border-secondary)",background:"var(--bg-card-secondary)"},children:[(0,s.jsx)("h3",{className:"font-medium",style:{color:"var(--text-secondary)"},children:"Write / Delete Data"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"key",className:"block text-sm font-medium",style:{color:"var(--text-primary)"},children:"Key:"}),(0,s.jsx)("input",{type:"text",id:"key",value:c,onChange:e=>d(e.target.value),placeholder:"Enter key",className:"mt-1 block w-full p-2 rounded-md shadow-sm",style:{border:"1px solid var(--border-primary)",background:"var(--bg-input)",color:"var(--text-primary)"}})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"value",className:"block text-sm font-medium",style:{color:"var(--text-primary)"},children:"Value (optional for Delete):"}),(0,s.jsx)("input",{type:"text",id:"value",value:m,onChange:e=>u(e.target.value),placeholder:"Enter value",className:"mt-1 block w-full p-2 rounded-md shadow-sm",style:{border:"1px solid var(--border-primary)",background:"var(--bg-input)",color:"var(--text-primary)"}})]}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsxs)("button",{onClick:()=>{c.trim()?(t(c.trim(),m),d(""),u("")):alert("Key cannot be empty for write.")},className:"flex-1 px-4 py-2 rounded-md flex items-center justify-center transition-colors",style:{background:"var(--btn-blue-bg)",color:"var(--text-inverse)"},onMouseEnter:e=>e.currentTarget.style.background="var(--btn-blue-hover)",onMouseLeave:e=>e.currentTarget.style.background="var(--btn-blue-bg)",children:[(0,s.jsx)(p.A,{size:18,className:"mr-2"})," Write"]}),(0,s.jsxs)("button",{onClick:()=>{c.trim()?(l(c.trim()),d(""),u("")):alert("Key cannot be empty for delete.")},className:"flex-1 px-4 py-2 rounded-md flex items-center justify-center transition-colors",style:{background:"var(--btn-red-bg)",color:"var(--text-inverse)"},onMouseEnter:e=>e.currentTarget.style.background="var(--btn-red-hover)",onMouseLeave:e=>e.currentTarget.style.background="var(--btn-red-bg)",children:[(0,s.jsx)(y.A,{size:18,className:"mr-2"})," Delete"]})]})]}),(0,s.jsxs)("div",{className:"space-y-3 p-3 rounded-md",style:{border:"1px solid var(--border-secondary)",background:"var(--bg-card-secondary)"},children:[(0,s.jsx)("h3",{className:"font-medium",style:{color:"var(--text-secondary)"},children:"Read Data"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"readKey",className:"block text-sm font-medium",style:{color:"var(--text-primary)"},children:"Key to Read:"}),(0,s.jsx)("input",{type:"text",id:"readKey",value:b,onChange:e=>h(e.target.value),placeholder:"Enter key to read",className:"mt-1 block w-full p-2 rounded-md shadow-sm",style:{border:"1px solid var(--border-primary)",background:"var(--bg-input)",color:"var(--text-primary)"}})]}),(0,s.jsxs)("button",{onClick:()=>{b.trim()?a(b.trim()):alert("Key cannot be empty for read.")},className:"w-full px-4 py-2 rounded-md flex items-center justify-center transition-colors",style:{background:"var(--btn-green-bg)",color:"var(--text-inverse)"},onMouseEnter:e=>e.currentTarget.style.background="var(--btn-green-hover)",onMouseLeave:e=>e.currentTarget.style.background="var(--btn-green-bg)",children:[(0,s.jsx)(S.A,{size:18,className:"mr-2"})," Read"]})]})]}),(0,s.jsxs)("div",{className:"mt-4 pt-4 flex flex-wrap gap-2",style:{borderTop:"1px solid var(--border-secondary)"},children:[" ",(0,s.jsxs)("button",{onClick:()=>r(0),disabled:n,className:"px-4 py-2 rounded-md flex items-center justify-center transition-colors",style:{background:n?"var(--btn-gray-bg)":"var(--btn-purple-bg)",color:"var(--text-inverse)",cursor:n?"not-allowed":"pointer"},onMouseEnter:e=>!n&&(e.currentTarget.style.background="var(--btn-purple-hover)"),onMouseLeave:e=>!n&&(e.currentTarget.style.background="var(--btn-purple-bg)"),children:[(0,s.jsx)(j.A,{size:18,className:"mr-2"})," Trigger L0 Compaction"]}),(0,s.jsxs)("button",{onClick:i,className:"px-4 py-2 rounded-md flex items-center justify-center transition-colors",style:{background:"var(--btn-gray-bg)",color:"var(--text-inverse)"},onMouseEnter:e=>e.currentTarget.style.background="var(--btn-gray-hover)",onMouseLeave:e=>e.currentTarget.style.background="var(--btn-gray-bg)",children:[(0,s.jsx)(T.A,{size:18,className:"mr-2"})," Reset Tree"]})]})]})},N=e=>{let{itemKey:t,itemValue:a,highlight:l}=e,[r,n]=(0,o.useState)(!1);(0,o.useEffect)(()=>{let e=setTimeout(()=>n(!0),10);return()=>clearTimeout(e)},[]);let c=a===i;return(0,s.jsxs)("div",{className:"px-2 py-1 rounded-md text-xs transition-all duration-500 ease-in-out transform ".concat(r?"opacity-100 scale-100":"opacity-0 scale-90"),style:{border:c?"1px solid var(--dataitem-tombstone-border)":"1px solid var(--dataitem-border)",background:c?"var(--dataitem-tombstone-bg)":"var(--dataitem-bg)",boxShadow:l?"0 0 0 2px var(--border-focus), var(--shadow-lg)":"none"},children:[(0,s.jsxs)("span",{className:"font-semibold break-all",style:{color:"var(--dataitem-key-text)"},children:[t,":"]}),(0,s.jsx)("span",{className:"break-all ".concat(c?"italic":""),style:{color:c?"var(--dataitem-tombstone-text)":"var(--dataitem-value-text)"},children:c?" (TOMBSTONE)":" ".concat(a)})]})},L=e=>{let{memtableData:t,maxSize:a,readPathItem:l}=e,[r,i]=(0,o.useState)(!0);return(0,s.jsxs)("div",{className:"p-4 rounded-lg shadow-sm mb-4 transition-all duration-300 ease-in-out ".concat((null==l?void 0:l.status)==="Checking"?"animate-pulse":""),style:{border:"1px solid var(--memtable-border)",background:"var(--memtable-bg)",...(()=>{var e;return(null==l?void 0:l.status)==="Checking"?{boxShadow:"0 0 0 2px var(--status-checking-ring)"}:(null==l||null==(e=l.status)?void 0:e.startsWith("Found"))?{boxShadow:"0 0 0 2px var(--status-found-ring)"}:{}})()},children:[(0,s.jsxs)("button",{onClick:()=>i(!r),className:"w-full text-left font-semibold mb-2 flex items-center",style:{color:"var(--memtable-text)"},children:[r?(0,s.jsx)(h.A,{size:20,className:"mr-1"}):(0,s.jsx)(x.A,{size:20,className:"mr-1"}),"MemTable (Size: ",t.length," / ",a,")",l&&(0,s.jsx)("span",{className:"ml-2 text-xs px-1.5 py-0.5 rounded",style:{background:"Found"===l.status?"var(--status-found-bg)":"Found (Tombstone)"===l.status?"var(--status-tombstone-bg)":"Checking"===l.status?"var(--status-checking-bg)":"var(--bg-card-secondary)",color:"Found"===l.status?"var(--status-found-text)":"Found (Tombstone)"===l.status?"var(--status-tombstone-text)":"Checking"===l.status?"var(--status-checking-text)":"var(--text-secondary)"},children:l.status})]}),r&&(0,s.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-2",children:[0===t.length&&(0,s.jsx)("p",{className:"text-sm italic col-span-full",style:{color:"var(--text-tertiary)"},children:"Empty"}),t.map(e=>{let[t,a]=e;return(0,s.jsx)(N,{itemKey:t,itemValue:a},"mem-".concat(t))})]})]})},M=e=>{let{sstable:t,readPathItem:a}=e,[l,r]=(0,o.useState)(!1),[i,n]=(0,o.useState)(!1);return(0,o.useEffect)(()=>{let e=setTimeout(()=>n(!0),10);return()=>clearTimeout(e)},[]),(0,s.jsxs)("div",{className:"p-3 rounded-lg mb-2 relative transition-all duration-500 ease-in-out transform ".concat(i?"opacity-100 scale-100":"opacity-0 scale-95"," ").concat((null==a?void 0:a.status)==="Checking"?"animate-pulse":""),style:{border:"1px solid var(--sstable-border)",background:"var(--sstable-bg)",...(()=>{var e;return(null==a?void 0:a.status)==="Checking"?{boxShadow:"0 0 0 2px var(--status-checking-ring)"}:(null==a||null==(e=a.status)?void 0:e.startsWith("Found"))?{boxShadow:"0 0 0 2px var(--status-found-ring)"}:{boxShadow:"var(--shadow-sm)"}})()},children:[(0,s.jsxs)("button",{onClick:()=>r(!l),className:"w-full text-left text-sm font-medium mb-1 flex items-center",style:{color:"var(--text-primary)"},children:[l?(0,s.jsx)(h.A,{size:18,className:"mr-1"}):(0,s.jsx)(x.A,{size:18,className:"mr-1"}),"SSTable:"," ",(0,s.jsx)("span",{className:"font-mono text-xs ml-1 mr-1 px-1 rounded",style:{background:"var(--sstable-id-bg)"},children:t.id.substring(t.id.length-5)})," ","(",t.data.length," items)",a&&(0,s.jsx)("span",{className:"ml-2 text-xs px-1.5 py-0.5 rounded",style:{background:"Found"===a.status?"var(--status-found-bg)":"Found (Tombstone)"===a.status?"var(--status-tombstone-bg)":"Checking"===a.status?"var(--status-checking-bg)":"var(--bg-card-secondary)",color:"Found"===a.status?"var(--status-found-text)":"Found (Tombstone)"===a.status?"var(--status-tombstone-text)":"Checking"===a.status?"var(--status-checking-text)":"var(--text-secondary)"},children:a.status})]}),t.minKey&&t.maxKey&&(0,s.jsxs)("div",{className:"text-xs mb-1 ml-5",style:{color:"var(--text-tertiary)"},children:["Range: [",t.minKey," - ",t.maxKey,"]"]}),l&&(0,s.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-1 pl-2",children:[0===t.data.length&&(0,s.jsx)("p",{className:"text-xs italic col-span-full",style:{color:"var(--text-tertiary)"},children:"Empty"}),t.data.map(e=>{let[a,l]=e;return(0,s.jsx)(N,{itemKey:a,itemValue:l},"".concat(t.id,"-").concat(a))})]})]})},w=e=>{let{level:t,levelIdx:a,readPath:l}=e,[r,i]=(0,o.useState)(!0);return(0,s.jsxs)("div",{className:"p-3 rounded-lg mb-3",style:{background:"var(--level-".concat(a,"-bg)"),border:"1px solid var(--level-".concat(a,"-border)"),boxShadow:"var(--shadow-sm)"},children:[(0,s.jsxs)("button",{onClick:()=>i(!r),className:"w-full text-left text-md font-semibold mb-2 flex items-center",style:{color:"var(--text-primary)"},children:[r?(0,s.jsx)(h.A,{size:20,className:"mr-1"}):(0,s.jsx)(x.A,{size:20,className:"mr-1"}),"Level ",a," (",t.length," SSTables)"]}),r&&(0===t.length?(0,s.jsx)("p",{className:"text-sm italic ml-5",style:{color:"var(--text-tertiary)"},children:"Empty"}):(0,s.jsx)("div",{className:"space-y-2",children:t.map(e=>(0,s.jsx)(M,{sstable:e,readPathItem:null==l?void 0:l.find(t=>t.id===e.id)},e.id))}))]})};var A=a(9397);let z=e=>{let{logs:t}=e,[a,l]=(0,o.useState)(!0),r=(0,o.useRef)(null);return(0,o.useEffect)(()=>{a&&r.current&&(r.current.scrollTop=0)},[t,a]),(0,s.jsxs)("div",{className:"p-4 rounded-lg",style:{background:"var(--log-bg)",color:"var(--log-text)",boxShadow:"var(--shadow-lg)"},children:[(0,s.jsxs)("button",{onClick:()=>l(!a),className:"w-full text-left font-semibold mb-2 flex items-center",style:{color:"var(--log-text)"},children:[a?(0,s.jsx)(h.A,{size:20,className:"mr-1"}):(0,s.jsx)(x.A,{size:20,className:"mr-1"}),(0,s.jsx)(A.A,{size:18,className:"mr-2"})," Activity Log"]}),a&&(0,s.jsxs)("div",{ref:r,className:"h-60 overflow-y-auto space-y-1 text-sm font-mono pt-2",style:{borderTop:"1px solid var(--log-border)"},children:[0===t.length&&(0,s.jsx)("p",{className:"italic",style:{color:"var(--log-text-secondary)"},children:"No activities yet."}),t.map((e,t)=>(0,s.jsxs)("div",{className:"whitespace-pre-wrap px-1 rounded transition-colors",style:{cursor:"default"},onMouseEnter:e=>e.currentTarget.style.background="var(--log-hover)",onMouseLeave:e=>e.currentTarget.style.background="transparent",children:[(0,s.jsx)("span",{className:"select-none",style:{color:"var(--log-text-secondary)"},children:e.time}),":"," ",(0,s.jsx)("span",{style:{color:"var(--log-text)"},children:e.text})]},t))]})]})};var C=a(235);let E=e=>{let{metrics:t}=e,[a,l]=(0,o.useState)(!0),r=[{label:"Logical Writes",value:t.logicalWrites,tip:"Total 'put' or 'delete' operations initiated by the user."},{label:"Items Written to SSTables",value:t.itemsWrittenToSSTables,tip:"Total number of items (key-value pairs) physically written to SSTable objects (during flush or compaction)."},{label:"Write Amplification (WA)",value:t.writeAmplification,tip:"(Items Written to SSTables) / (Logical Writes). Ideal is 1. Higher values mean more I/O for writes."},{label:"Logical Reads",value:t.logicalReads,tip:"Total 'get' operations initiated by the user."},{label:"MemTable Lookups (Read)",value:t.memtableLookupsForRead,tip:"Number of times MemTable was checked during read operations."},{label:"SSTables Accessed (Read)",value:t.sstablesAccessedForRead,tip:"Total number of SSTables accessed (opened/checked) during read operations."},{label:"Read Amplification (SSTables)",value:t.readAmplificationSSTables,tip:"(SSTables Accessed) / (Logical Reads). Average SSTables checked per read. Ideal is low."}];return t?(0,s.jsxs)("div",{className:"p-4 rounded-lg mb-6",style:{background:"var(--bg-card)",boxShadow:"var(--shadow-md)"},children:[(0,s.jsxs)("button",{onClick:()=>l(!a),className:"w-full text-left text-xl font-semibold mb-3 flex items-center",style:{color:"var(--text-primary)"},children:[a?(0,s.jsx)(h.A,{size:20,className:"mr-2"}):(0,s.jsx)(x.A,{size:20,className:"mr-2"}),(0,s.jsx)(C.A,{size:22,className:"mr-2",style:{color:"var(--metrics-value-text)"}})," Performance Metrics"]}),a&&(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:r.map(e=>(0,s.jsxs)("div",{className:"p-3 rounded-md",style:{background:"var(--bg-card-secondary)",border:"1px solid var(--border-secondary)"},children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h4",{className:"text-sm font-medium",style:{color:"var(--text-secondary)"},children:e.label}),(0,s.jsx)(v,{text:e.tip,children:(0,s.jsx)(g.A,{size:14,className:"cursor-help",style:{color:"var(--text-tertiary)"}})})]}),(0,s.jsx)("p",{className:"text-2xl font-semibold mt-1",style:{color:"var(--metrics-value-text)"},children:e.value})]},e.label))})]}):null};var _=a(2098),F=a(3509),K=a(4738),R=a(5220);let I=()=>{let{theme:e,setTheme:t}=(0,R.D)(),a=()=>{switch(e){case"light":return"Light";case"dark":return"Dark";default:return"System"}};return(0,s.jsxs)("button",{onClick:()=>{let a=["system","light","dark"],s=(a.indexOf(e)+1)%a.length;t(a[s])},className:"p-2 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-md hover:bg-gray-300 dark:hover:bg-gray-600 flex items-center transition-colors",title:"Theme: ".concat(a()),children:[(()=>{switch(e){case"light":return(0,s.jsx)(_.A,{size:20});case"dark":return(0,s.jsx)(F.A,{size:20});default:return(0,s.jsx)(K.A,{size:20})}})(),(0,s.jsx)("span",{className:"ml-2 text-sm font-medium hidden sm:inline",children:a()})]})},D={LSM_CONFIG:"lsm_config",TREE_STATE:"tree_state",READ_VALUE:"read_value",READ_PATH:"read_path"},W=(e,t)=>{try{localStorage.setItem(e,JSON.stringify(t))}catch(e){console.error("Error saving to localStorage:",e)}},O=(e,t)=>{try{let a=localStorage.getItem(e);return a?JSON.parse(a):t}catch(e){return console.error("Error loading from localStorage:",e),t}},V=e=>({loadPersistedState:()=>{let t=O(D.LSM_CONFIG,e),a=O(D.TREE_STATE,null);return{config:t,treeState:a,readValue:O(D.READ_VALUE,null),readPath:O(D.READ_PATH,[])}},saveState:(e,t,a,s)=>{W(D.LSM_CONFIG,e),W(D.TREE_STATE,t),W(D.READ_VALUE,a),W(D.READ_PATH,s)},clearPersistedState:()=>{Object.values(D).forEach(e=>localStorage.removeItem(e))}}),P=()=>{let e=(0,o.useMemo)(()=>({memtableMaxSize:5,l0MaxSSTables:3,levelMaxSSTablesFactor:4,sstableMaxItems:10,maxLevels:5}),[]),{loadPersistedState:t,saveState:a,clearPersistedState:l}=V(e),[n,c]=(0,o.useState)(!1),[d,m]=(0,o.useState)(()=>new u(e)),[b,h]=(0,o.useState)(()=>d.getState()),[x,g]=(0,o.useState)(!1),[v,p]=(0,o.useState)(null),[y,S]=(0,o.useState)([]);(0,o.useEffect)(()=>{if(!n){c(!0);let e=t();if(e.config){let t=new u(e.config);m(t),h(e.treeState||t.getState())}e.readValue&&p(e.readValue),e.readPath&&S(e.readPath)}},[n,t]),(0,o.useEffect)(()=>{n&&a(d.config,b,v,y)},[b,v,y,d.config,a,n]);let j=(0,o.useCallback)(()=>{h(d.getState())},[d]),T=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;g(!0),await new Promise(e=>setTimeout(e,50)),d.compact(e),j(),g(!1),p(null),S([])},N=e=>{let t=new u(e||d.config);m(t),h(t.getState()),p(null),S([]),l()},M=e=>{N(e)};return(0,s.jsxs)("div",{style:{background:"var(--bg-page)"},className:"jsx-3eba093054a1fc33 min-h-screen p-4 md:p-8 font-sans",children:[(0,s.jsxs)("div",{className:"jsx-3eba093054a1fc33 max-w-7xl mx-auto",children:[(0,s.jsxs)("header",{className:"jsx-3eba093054a1fc33 mb-8 text-center",children:[(0,s.jsx)("h1",{style:{color:"var(--text-primary)"},className:"jsx-3eba093054a1fc33 text-4xl font-bold",children:"LSM Tree Visualization"}),(0,s.jsx)("p",{style:{color:"var(--text-secondary)"},className:"jsx-3eba093054a1fc33 text-lg",children:"Watch how a Log-Structured Merge Tree works interactively."})]}),(0,s.jsxs)("div",{className:"jsx-3eba093054a1fc33 mb-4 flex gap-2 items-start",children:[(0,s.jsx)(f,{initialConfig:d.config,onSave:M,onResetDefault:()=>{M(e)}}),(0,s.jsx)(I,{})]}),(0,s.jsx)(k,{onWrite:(e,t)=>{d.put(e,t),j(),p(null),S([])},onRead:e=>{let t=d.get(e);p(t),S(t.path||[]),j()},onDelete:e=>{d.delete(e),j(),p(null),S([])},onCompact:T,onResetTree:()=>N(d.config),isCompacting:x}),b.metrics&&(0,s.jsx)(E,{metrics:b.metrics}),v&&(0,s.jsxs)("div",{style:{background:"var(--read-result-bg)",borderColor:"var(--read-result-border)",borderWidth:"1px",borderStyle:"solid"},className:"jsx-3eba093054a1fc33 my-4 p-4 rounded-lg shadow animate-fadeIn",children:[(0,s.jsx)("h3",{style:{color:"var(--read-result-text)"},className:"jsx-3eba093054a1fc33 text-lg font-semibold",children:"Read Result:"}),void 0===v.value&&(0,s.jsx)("p",{style:{color:"var(--read-result-text)"},className:"jsx-3eba093054a1fc33",children:"Key not found."}),v.value===i&&(0,s.jsx)("p",{style:{color:"var(--dataitem-tombstone-text)"},className:"jsx-3eba093054a1fc33",children:"Key found: Marked as DELETED (TOMBSTONE)."}),void 0!==v.value&&v.value!==i&&(0,s.jsxs)("p",{style:{color:"var(--read-result-text)"},className:"jsx-3eba093054a1fc33",children:["Key found:"," ",(0,s.jsx)("span",{className:"jsx-3eba093054a1fc33 font-bold",children:JSON.stringify(v.value)})]})]}),(0,s.jsxs)("div",{className:"jsx-3eba093054a1fc33 mt-6 grid grid-cols-1 xl:grid-cols-3 gap-6",children:[(0,s.jsxs)("div",{className:"jsx-3eba093054a1fc33 xl:col-span-2",children:[(0,s.jsx)("h2",{style:{color:"var(--text-primary)"},className:"jsx-3eba093054a1fc33 text-2xl font-semibold mb-3",children:"LSM Tree Structure"}),(0,s.jsx)(L,{memtableData:b.memtable,maxSize:b.config.memtableMaxSize,readPathItem:null==y?void 0:y.find(e=>"memtable"===e.id)}),b.levels.map((e,t)=>(0,s.jsx)(w,{level:e,levelIdx:t,readPath:y},t))]}),(0,s.jsxs)("div",{className:"jsx-3eba093054a1fc33 xl:col-span-1",children:[(0,s.jsx)("h2",{style:{color:"var(--text-primary)"},className:"jsx-3eba093054a1fc33 text-2xl font-semibold mb-3",children:"Operations Log"}),(0,s.jsx)(z,{logs:b.log})]})]}),(0,s.jsx)("footer",{style:{color:"var(--text-tertiary)",borderTop:"1px solid var(--border-secondary)"},className:"jsx-3eba093054a1fc33 mt-12 text-center text-sm py-6",children:(0,s.jsxs)("p",{className:"jsx-3eba093054a1fc33",children:["LSM Tree Visualization. Vibe coded with â¤ by"," ",(0,s.jsx)("a",{href:"https://github.com/vnayakg",className:"jsx-3eba093054a1fc33",children:(0,s.jsx)("u",{className:"jsx-3eba093054a1fc33",children:"human"})})]})})]}),(0,s.jsx)(r(),{id:"3eba093054a1fc33",children:".animate-fadeIn{-webkit-animation:fadeIn.5s ease-in-out;-moz-animation:fadeIn.5s ease-in-out;-o-animation:fadeIn.5s ease-in-out;animation:fadeIn.5s ease-in-out}@-webkit-keyframes fadeIn{0%{opacity:0;-webkit-transform:translatey(-10px);transform:translatey(-10px)}100%{opacity:1;-webkit-transform:translatey(0);transform:translatey(0)}}@-moz-keyframes fadeIn{0%{opacity:0;-moz-transform:translatey(-10px);transform:translatey(-10px)}100%{opacity:1;-moz-transform:translatey(0);transform:translatey(0)}}@-o-keyframes fadeIn{0%{opacity:0;-o-transform:translatey(-10px);transform:translatey(-10px)}100%{opacity:1;-o-transform:translatey(0);transform:translatey(0)}}@keyframes fadeIn{0%{opacity:0;-webkit-transform:translatey(-10px);-moz-transform:translatey(-10px);-o-transform:translatey(-10px);transform:translatey(-10px)}100%{opacity:1;-webkit-transform:translatey(0);-moz-transform:translatey(0);-o-transform:translatey(0);transform:translatey(0)}}.animate-pulse{-webkit-animation:pulse 1.5s cubic-bezier(.4,0,.6,1)infinite;-moz-animation:pulse 1.5s cubic-bezier(.4,0,.6,1)infinite;-o-animation:pulse 1.5s cubic-bezier(.4,0,.6,1)infinite;animation:pulse 1.5s cubic-bezier(.4,0,.6,1)infinite}@-webkit-keyframes pulse{0%,100%{opacity:1}50%{opacity:.5}}@-moz-keyframes pulse{0%,100%{opacity:1}50%{opacity:.5}}@-o-keyframes pulse{0%,100%{opacity:1}50%{opacity:.5}}@keyframes pulse{0%,100%{opacity:1}50%{opacity:.5}}"})]})}},6633:(e,t,a)=>{Promise.resolve().then(a.bind(a,6326))}},e=>{var t=t=>e(e.s=t);e.O(0,[685,441,684,358],()=>t(6633)),_N_E=e.O()}]);